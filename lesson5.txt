1.  Найдите потоки, количество учеников в которых больше или равно 40. 
    В отчет выведите номер потока, название курса и количество учеников.
    SELECT 
        number, 
        (SELECT name FROM courses WHERE courses.id = streams.course_id) AS course_name, 
        count_students 
    FROM streams WHERE count_students >= 40;

2.  Найдите два потока с самыми низкими значениями успеваемости. В отчет выведите номер потока, 
    название курса, фамилию и имя преподавателя (одним столбцом), оценку успеваемости.
    SELECT 
        (SELECT number FROM streams WHERE streams.id = grades.stream_id) AS stream_number,
        (SELECT name FROM courses WHERE courses.id = 
            (SELECT course_id FROM streams WHERE streams.id = grades.stream_id)
        ) AS course_name,
        (SELECT name || ' ' || surname FROM teachers WHERE teachers.id = grades.teacher_id) AS teacher,
        grade
    FROM grades ORDER BY grade ASC LIMIT 2;

3.  Найдите среднюю успеваемость всех потоков преподавателя Николая Савельева. 
    В отчёт выведите идентификатор преподавателя и среднюю оценку по потокам.
    SELECT 
        (SELECT id FROM teachers WHERE teachers.id = grades.teacher_id 
            AND teachers.name = 'Николай' 
            AND teachers.surname = 'Савельев'
        ) AS teacher,
        AVG(grade)
    FROM grades GROUP BY teacher_id HAVING teacher_id = teacher;

4.  Найдите потоки преподавателя Натальи Петровой, а также потоки, по которым успеваемость ниже 4.8. 
    В отчёт выведите идентификатор потока, фамилию и имя преподавателя.
    SELECT
        (SELECT number FROM streams WHERE streams.id = grades.stream_id) AS stream,
        (SELECT name || ' ' || surname FROM teachers WHERE teachers.name = 'Наталья' AND teachers.surname = 'Петрова') AS teacher
    FROM grades
    WHERE teacher_id = (
        SELECT id FROM teachers WHERE teachers.name = 'Наталья' AND teachers.surname = 'Петрова'
    )

    UNION ALL

    SELECT
        (SELECT number FROM streams) AS stream,
        (SELECT name || ' ' || surname FROM teachers WHERE teachers.id = grades.teacher_id) AS teacher
    FROM grades
    WHERE grade < 4.8;

